========================================
ì¹´ì¹´ì˜¤í†¡ ê³µìœ  ê´€ë ¨ HTML ì½”ë“œ
========================================

[1] generateSummaryText() - í…ìŠ¤íŠ¸ ìš”ì•½ ìƒì„± í•¨ìˆ˜
========================================
function generateSummaryText() {
    let text = `ğŸ“Š ${currentSiteName}\n`;
    text += `${new Date().toLocaleDateString('ko-KR')} (ë¡œìŠ¤ìœ¨ ${Math.round(currentLossRate * 100)}%)\n\n`;
    
    // ì„ê³ ë³´ë“œ ì¢…ë¥˜ë³„ ì§‘ê³„
    const groupedByType = {};
    const groupedByWood = {};
    const groupedBySteel = {};
    
    walls.forEach(wall => {
        if (wall.width && wall.height) {
            const area = (wall.width * wall.height) / 1000000;
            const boardArea = getBoardArea(wall.boardSize);
            let boards = (area / boardArea);
            boards *= (wall.constructionSide === '2P' ? 2 : 1);
            boards *= (wall.faceDirection === 'ì–‘ë©´' ? 2 : 1);
            boards *= (1 + currentLossRate);
            const finalBoards = Math.ceil(boards);
            
            // ì„ê³ ë³´ë“œ ì§‘ê³„
            const boardKey = `${wall.boardType}-${wall.boardSize}-${wall.boardThickness}`;
            if (!groupedByType[boardKey]) {
                groupedByType[boardKey] = {
                    type: wall.boardType,
                    size: wall.boardSize,
                    thickness: wall.boardThickness,
                    totalBoards: 0
                };
            }
            groupedByType[boardKey].totalBoards += finalBoards;
            
            // ëª©ìì¬ ì§‘ê³„
            if (wall.joistType === 'ëª©ìì¬') {
                const joistKey = wall.woodType;
                if (!groupedByWood[joistKey]) {
                    let woodName = wall.woodType;
                    let woodSize = '';
                    if (wall.woodType === 'í•œì¹˜ê°') {
                        woodName = 'í•œì¹˜ê°';
                        woodSize = '30Ã—30';
                    } else if (wall.woodType === 'í•œì¹˜ê°ë°˜') {
                        woodName = 'í•œì¹˜ê°ë°˜';
                        woodSize = '30Ã—45';
                    } else if (wall.woodType.includes('SPF')) {
                        woodName = wall.woodType;
                        woodSize = '38Ã—89';
                    } else if (wall.woodType.includes('Ã—')) {
                        const parts = wall.woodType.split(' ');
                        woodName = parts[0];
                        woodSize = parts[0];
                    } else {
                        woodName = wall.woodType;
                        woodSize = '';
                    }
                    
                    groupedByWood[joistKey] = { 
                        name: woodName,
                        size: woodSize,
                        count: 0 
                    };
                }
                const verticalCount = Math.floor(wall.width / wall.joistSpacing) + 1;
                const horizontal = Math.ceil(wall.width / 2700) * 2;
                let total = verticalCount + horizontal;
                total *= (wall.faceDirection === 'ì–‘ë©´' ? 2 : 1);
                groupedByWood[joistKey].count += Math.ceil(total * (1 + currentLossRate));
            }
            
            // ê²½ëŸ‰ì² ê³¨ ì§‘ê³„
            if (wall.joistType === 'ê²½ëŸ‰ì² ê³¨') {
                const spacing = 450;
                
                const runnerKey = `ëŸ¬ë„ˆ-${wall.steelThickness}-${wall.steelLength}`;
                if (!groupedBySteel[runnerKey]) {
                    groupedBySteel[runnerKey] = {
                        type: 'ëŸ¬ë„ˆ',
                        thickness: wall.steelThickness,
                        length: wall.steelLength,
                        count: 0
                    };
                }
                let runnerPieces = Math.ceil(wall.width / wall.steelLength) * 2;
                runnerPieces *= (wall.faceDirection === 'ì–‘ë©´' ? 2 : 1);
                groupedBySteel[runnerKey].count += Math.ceil(runnerPieces * (1 + currentLossRate));
                
                const studKey = `ìŠ¤í„°ë“œ-${wall.steelThickness}-${wall.steelLength}`;
                if (!groupedBySteel[studKey]) {
                    groupedBySteel[studKey] = {
                        type: 'ìŠ¤í„°ë“œ',
                        thickness: wall.steelThickness,
                        length: wall.steelLength,
                        count: 0
                    };
                }
                const studCount = Math.floor(wall.width / spacing) + 1;
                const piecesPerStud = Math.ceil(wall.height / wall.steelLength);
                let totalStud = studCount * piecesPerStud;
                totalStud *= (wall.faceDirection === 'ì–‘ë©´' ? 2 : 1);
                groupedBySteel[studKey].count += Math.ceil(totalStud * (1 + currentLossRate));
            }
        }
    });
    
    // ì„ê³ ë³´ë“œ ì¶œë ¥ (í•œ ì¤„ë¡œ)
    text += `[ì„ê³ ë³´ë“œ]\n`;
    Object.keys(groupedByType).forEach(key => {
        const board = groupedByType[key];
        text += `${board.type} ${board.size} ${board.thickness} - ${board.totalBoards}ì¥\n`;
    });
    
    // ëª©ìì¬ ì¶œë ¥ (í•œ ì¤„ë¡œ)
    if (Object.keys(groupedByWood).length > 0) {
        text += `\n[ëª©ìì¬]\n`;
        Object.keys(groupedByWood).forEach(key => {
            const wood = groupedByWood[key];
            text += `${wood.name}`;
            if (wood.size) {
                text += ` ${wood.size}`;
            }
            text += ` - ${wood.count}ê°œ\n`;
        });
    }
    
    // ê²½ëŸ‰ì² ê³¨ ì¶œë ¥ (í•œ ì¤„ë¡œ)
    if (Object.keys(groupedBySteel).length > 0) {
        text += `\n[ê²½ëŸ‰ì² ê³¨]\n`;
        Object.keys(groupedBySteel).forEach(key => {
            const steel = groupedBySteel[key];
            text += `${steel.type} ${steel.thickness}mm ${steel.length}mm - ${steel.count}ê°œ\n`;
        });
    }
    
    return text;
}


[2] shareToKakao() - ì¹´ì¹´ì˜¤í†¡ ê³µìœ  ë©”ì¸ í•¨ìˆ˜
========================================
async function shareToKakao() {
    closeShareModal();
    
    // í…ìŠ¤íŠ¸ ìš”ì•½ ìƒì„±
    const textSummary = generateSummaryText();
    
    const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
    
    // ëª¨ë°”ì¼ì—ì„œ Web Share API ì‹œë„
    if (isMobile && navigator.share) {
        try {
            // ë¨¼ì € í´ë¦½ë³´ë“œì— ë³µì‚¬
            if (navigator.clipboard) {
                await navigator.clipboard.writeText(textSummary);
            }
            
            // Web Share API í˜¸ì¶œ
            await navigator.share({
                text: textSummary
            });
            showToast('âœ… ì¹´ì¹´ì˜¤í†¡ìœ¼ë¡œ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤!');
            return;
        } catch (error) {
            if (error.name !== 'AbortError') {
                console.error('Web Share ì‹¤íŒ¨:', error);
                // Web Share ì‹¤íŒ¨ ì‹œ í´ë¦½ë³´ë“œë§Œ ì‚¬ìš©
            }
        }
    }
    
    // PC ë˜ëŠ” Web Share ì‹¤íŒ¨ ì‹œ: í´ë¦½ë³´ë“œì— ë³µì‚¬
    copyToClipboard(textSummary);
}


[3] copyToClipboard() - í´ë¦½ë³´ë“œ ë³µì‚¬ í•¨ìˆ˜
========================================
function copyToClipboard(text) {
    if (navigator.clipboard) {
        navigator.clipboard.writeText(text).then(() => {
            showToast('ğŸ“‹ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!\nì¹´ì¹´ì˜¤í†¡ì— ë¶™ì—¬ë„£ê¸° í•˜ì„¸ìš”.');
            
            // ë³µì‚¬ëœ ë‚´ìš© í™•ì¸ìš© ë¡œê·¸
            console.log('ë³µì‚¬ëœ í…ìŠ¤íŠ¸:', text);
        }).catch((err) => {
            console.error('í´ë¦½ë³´ë“œ ë³µì‚¬ ì‹¤íŒ¨:', err);
            fallbackCopy(text);
        });
    } else {
        fallbackCopy(text);
    }
}


[4] fallbackCopy() - ëŒ€ì²´ ë³µì‚¬ ë°©ë²•
========================================
function fallbackCopy(text) {
    const textarea = document.createElement('textarea');
    textarea.value = text;
    textarea.style.position = 'fixed';
    textarea.style.opacity = '0';
    document.body.appendChild(textarea);
    textarea.select();
    
    try {
        document.execCommand('copy');
        showToast('ğŸ“‹ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!\nì¹´ì¹´ì˜¤í†¡ì— ë¶™ì—¬ë„£ê¸° í•˜ì„¸ìš”.');
        console.log('ë³µì‚¬ëœ í…ìŠ¤íŠ¸:', text);
    } catch (err) {
        console.error('ë³µì‚¬ ì‹¤íŒ¨:', err);
        alert('ğŸ“‹ ë³µì‚¬ ì‹¤íŒ¨\n\n' + text);
    }
    
    document.body.removeChild(textarea);
}


[5] shareSMS() - ë¬¸ì ì „ì†¡ í•¨ìˆ˜
========================================
function shareSMS() {
    closeShareModal();
    
    // í…ìŠ¤íŠ¸ ìš”ì•½ ìƒì„±
    const textSummary = generateSummaryText();
    
    // ë¬¸ì ì•± ì—´ê¸°
    const smsUrl = `sms:?body=${encodeURIComponent(textSummary)}`;
    window.location.href = smsUrl;
    
    showToast('ğŸ’Œ ë¬¸ì ì•±ì´ ì—´ë¦½ë‹ˆë‹¤!');
}


[6] shareEmail() - ì´ë©”ì¼ ì „ì†¡ í•¨ìˆ˜
========================================
function shareEmail() {
    closeShareModal();
    
    // í…ìŠ¤íŠ¸ ìš”ì•½ ìƒì„±
    const textSummary = generateSummaryText();
    
    // ì´ë©”ì¼ ì•± ì—´ê¸°
    const subject = encodeURIComponent(`${currentSiteName} - ì„ê³ ë³´ë“œ ê°ì¬ ì‚°ì¶œë‚´ì—­`);
    const body = encodeURIComponent(textSummary);
    const mailtoUrl = `mailto:?subject=${subject}&body=${body}`;
    window.location.href = mailtoUrl;
    
    showToast('ğŸ“§ ì´ë©”ì¼ ì•±ì´ ì—´ë¦½ë‹ˆë‹¤!');
}


[7] showToast() - í† ìŠ¤íŠ¸ ë©”ì‹œì§€ í‘œì‹œ í•¨ìˆ˜
========================================
function showToast(message) {
    let toast = document.getElementById('toast');
    if (!toast) {
        toast = document.createElement('div');
        toast.className = 'toast';
        toast.id = 'toast';
        document.body.appendChild(toast);
    }
    
    toast.innerHTML = message.replace(/\n/g, '<br>');
    toast.classList.add('show');
    
    setTimeout(() => {
        toast.classList.remove('show');
    }, 4000);
}


========================================
í˜„ì¬ ë¬¸ì œì  ë° í•´ê²° ë°©ì•ˆ
========================================

[ë¬¸ì œ] 
ì¹´ì¹´ì˜¤í†¡ ê³µìœ  ì‹œ ì‚°ì¶œ ë‚´ìš© ëŒ€ì‹  URLì´ ì „ì†¡ë¨

[ê°€ëŠ¥í•œ ì›ì¸]
1. Web Share APIê°€ text ëŒ€ì‹  í˜„ì¬ í˜ì´ì§€ URLì„ ê³µìœ 
2. generateSummaryText() í•¨ìˆ˜ì—ì„œ URLì´ í¬í•¨ë˜ê³  ìˆìŒ
3. ë¸Œë¼ìš°ì €ì˜ ê³µìœ  ê¸°ëŠ¥ì´ ë©”íƒ€ íƒœê·¸ì˜ URLì„ ìš°ì„  ì‚¬ìš©

[í•´ê²° ë°©ì•ˆ]
1. console.logë¡œ textSummary ë‚´ìš© í™•ì¸
2. Web Share API ëŒ€ì‹  ë‹¤ë¥¸ ë°©ë²• ì‹œë„
3. ë©”íƒ€ íƒœê·¸ í™•ì¸ ë° ìˆ˜ì •

========================================



